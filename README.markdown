# Sophos SIEM Log Viewer

This tool was written mostly with Grok xAI with prompts provided by me.

## Overview
Sophos SIEM Log Viewer is a desktop application designed to visualize and analyze JSON log files (including JSON Lines, `.jsonl`, `.json`, `.txt`, and `.cef` formats) generated by Sophos Central SIEM API. The application provides a tabular view of log data with features like filtering, color-coding based on severity or group, automatic and manual data refresh, and raw JSON inspection. It is built using Python and Tkinter, compiled into a standalone executable for ease of use.

https://support.sophos.com/support/s/article/KBA-000004400?language=en_US

This currently only supports the SIEM log file in the format json

## Features
- **Multi-Tab Interface**: Load and view multiple log files simultaneously in separate tabs.
- **Column Filtering**: Filter log entries by specific column values (e.g., `severity`, `source_info.ip`).
- **Color Coding**:
  - Customizable severity-based coloring (e.g., low: green, medium: yellow, high: red).
  - Group-based coloring for specific log groups (e.g., `AD_SYNC`).
- **Auto-Refresh**: Automatically syncs log files at user-defined intervals (default: 1 hour).
- **Manual Refresh**: Manually refresh log data to update the view.
- **Auto-Scroll**: Optionally scroll to the latest log entries automatically.
- **Raw JSON View**: Select a row to display its raw JSON data in a dedicated text pane.
- **Progress Feedback**: Displays a progress bar during data loading for large files.
- **Error Logging**: Logs application events and errors to `logviewer.log` for debugging.

## Requirements
- **Operating System**: Windows (the executable is compiled for Windows; other platforms may require running the Python script directly).
- **Disk Space**: Approximately 50-100 MB (depending on the compiled executable size).
- **Log Files**: JSON-based log files (`.json`, `.jsonl`, `.txt`, or `.cef`) from Sophos Central SIEM.

## Installation
1. **Download the Executable**:
   - Obtain the `SophosSIEMLogViewer.exe` from the release package or compile it from the source code using PyInstaller.
2. **Place the Executable**:
   - Copy the executable to a directory of your choice (e.g., `C:\Scripts\SophosSIEMLogViewer`).
3. **Ensure Log File Access**:
   - Place your log files in a directory accessible to the application, or be prepared to select them via the file dialog.

## Usage
1. **Launch the Application**:
   - Double-click `SophosSIEMLogViewer.exe` to start the application.
   - Alternatively, run it from the command line with optional log file arguments:
     ```bash
     SophosSIEMLogViewer.exe path/to/logfile1.jsonl path/to/logfile2.json
     ```
2. **Add Log Files**:
   - If no files are provided via command-line arguments, a file dialog will prompt you to select a log file.
   - Use the `File > Add File` menu to load additional log files, which will appear as new tabs.
3. **View and Filter Logs**:
   - Logs are displayed in a table with columns like `source_info.ip`, `severity`, `type`, `name`, etc.
   - Right-click a column header to filter by values or set a color for specific groups.
4. **Customize Display**:
   - Use `Options > Toggle Severity Colors` to enable/disable severity-based coloring.
   - Use `Options > Set Custom Severity Colors` to change colors for severity levels (low, medium, high).
   - Use `Options > Toggle Auto-Scroll` to enable/disable scrolling to the latest log entries.
5. **Sync Data**:
   - Use `Options > Manual Sync` to refresh all tabs immediately.
   - Use `Options > Set Automatic Sync Interval` to adjust the auto-refresh interval (in minutes).
6. **Inspect Raw JSON**:
   - Click a row in the table to view its raw JSON data in the text pane below the table.
7. **Check Status**:
   - The status bar at the top of each tab shows the number of records displayed, total records, last sync times, and the countdown to the next automatic sync.

## Log File Format
The application supports:
- **JSON Lines (`.jsonl`)**: Each line is a valid JSON object.
- **Standard JSON (`.json`)**: A single JSON array of objects or a single object.
- **Text Files (`.txt`, `.cef`)**: Treated as JSON Lines if each line is a valid JSON object.

Example log entry (JSON Lines):
```json
{"source_info.ip": "192.168.1.10", "severity": "high", "type": "alert", "name": "Malware Detected", "id": "12345", "group": "AD_SYNC", "rt": "2025-08-29T12:00:00Z", "dhost": "server1", "endpoint_id": "ep123", "endpoint_type": "workstation"}
```

## Troubleshooting
- **Error Loading JSON**: Ensure the log file is in a valid JSON or JSON Lines format. Check the `logviewer.log` file in the executable’s directory for detailed error messages.
- **Performance Issues**: For large log files, loading may take time. The progress bar indicates loading progress.
- **No Data Displayed**: Verify that the log file contains valid JSON objects and that filters are not excluding all data.
- **Syntax Errors**: If you encounter issues with the executable, ensure the source code was compiled with Python 3.6+ and all dependencies (e.g., `tkinter`, `json`) are included.

## Building from Source
If you prefer to run or modify the source code:
1. Ensure Python 3.6+ is installed with the `tkinter` module.
2. Install dependencies (usually included with standard Python):
   ```bash
   pip install pyinstaller
   ```
3. Run the script directly:
   ```bash
   python LogViewer-v11.3.py
   ```
4. Compile to an executable using PyInstaller:
   ```bash
   pyinstaller --onefile LogViewer-v11.3.py
   ```
   - The compiled executable will be in the `dist` folder.

## Logging
- The application logs events and errors to `logviewer.log` in the same directory as the executable.
- Check this file for debugging information if issues arise.

## License
This application is provided as-is for use with Sophos Central SIEM log files. No official license is specified; contact the developer for usage permissions.

## Contact
For support or feature requests, please contact the developer or open an issue on the project’s repository (if available).
